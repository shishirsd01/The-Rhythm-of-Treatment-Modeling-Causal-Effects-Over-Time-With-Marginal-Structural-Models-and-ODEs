# MSM-ODE
This repo holds the code for - The Rhythm of Treatment: Modeling Causal Effects Over Time With Marginal Structural Models and ODEs by Shishir.S.D , Dr. Mittinty Murthy (Flinders University)

Treatment in everyday care is reactive: doses change because patients change, creating time-varying confounding. Purely predictive models can fit well yet encode the wrong causal story (e.g., appearing to show that insulin raises glucose simply because insulin is given when glucose is high). We propose a novel population-level approach that pairs marginal structural model (MSM) weighting with ODE discovery (SINDy) to produce interpretable, deconfounded short-horizon glucose predictions from free-living CGM, insulin, and meal data. Stabilized generalized propensity scores reweight observations so treatment is as-if randomized given history; on this adjusted signal we learn a sparse ODE whose terms clinicians can inspect. Using the public HUPAâ€“UCM Type 1 diabetes dataset (5-min CGM, insulin, carbohydrates), we compare equations learned directly with those learned after MSM adjustment. The adjusted equations align with physiology (bolus lowers glucose; meals raise it) and achieve lower short-horizon RMSE and MAE than the unadjusted baseline, which reflects confounding by indication. In sum, the learned equations yield interpretable, deconfounded glucose trajectory predictions at the population level.
